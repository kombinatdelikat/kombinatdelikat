/* Contao Open Source CMS, (c) 2005-2014 Leo Feyer, LGPL license */
var Typobox={preInit:function(){var e;tinyMCEPopup.requireLangPack(),(e=tinyMCEPopup.getParam("external_image_list_url"))&&document.write('<script language="javascript" type="text/javascript" src="'+tinyMCEPopup.editor.documentBaseURI.toAbsolute(e)+'"></script>')},init:function(){var e=document.forms[0],t=tinyMCEPopup.editor;document.getElementById("srcbrowsercontainer").innerHTML=getBrowserHTML("srcbrowser","src","image","theme_advanced_image"),isVisible("srcbrowser")&&(document.getElementById("src").style.width="180px"),this.fillFileList("image_list","tinyMCEImageList"),this.fillModeList("mode_list"),this.fillRelList("rel_list"),TinyMCE_EditableSelects.init();var n=t.selection.getContent();if(!n||n.indexOf("image::")==-1)return;n=n.replace(/^.*\{\{image::/gi,""),n=n.replace(/\}\}.*$/i,""),n=n.replace(/\[&amp;\]|\[&\]|&amp;|&/gi,"?");var r=n.split("?"),i,s;e.src.value=r[0];for(s=1;s<r.length;s++){i=r[s].split("=");switch(i[0]){case"width":e.width.value=i[1];break;case"height":e.height.value=i[1];break;case"alt":e.alt.value=i[1];break;case"class":e.cssClass.value=i[1];break;case"mode":selectByValue(e,"mode_list",i[1],!0);break;case"rel":selectByValue(e,"rel_list",i[1],!0)}}},fillFileList:function(e,t){var n=tinyMCEPopup.dom,r=n.get(e);t=window[t],t&&t.length>0?(r.options[r.options.length]=new Option("",""),tinymce.each(t,function(e){r.options[r.options.length]=new Option(e[0],e[1])})):n.remove(n.getParent(e,"tr"))},fillModeList:function(e){var t=tinyMCEPopup.dom,n=t.get(e);n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_proportional"),"proportional"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_box"),"box"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_left_top"),"left_top"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_center_top"),"center_top"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_right_top"),"right_top"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_left_center"),"left_center"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_center_center"),"center_center"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_right_center"),"right_center"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_left_bottom"),"left_bottom"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_center_bottom"),"center_bottom"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_right_bottom"),"right_bottom")},fillRelList:function(e){var t=tinyMCEPopup.dom,n=t.get(e);n.options[n.options.length]=new Option(tinyMCEPopup.getLang("not_set"),""),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_rel_single"),"lightbox"),n.options[n.options.length]=new Option(tinyMCEPopup.getLang("typolinks_dlg.image_rel_multi"),"lightbox[multi]")},update:function(){var e=document.forms[0],t=tinyMCEPopup.editor;tinyMCEPopup.restoreSelection();if(e.src.value==""){tinyMCEPopup.close();return}var n=e.src.value,r="?";e.width.value&&(n+=r+"width="+e.width.value,r="&amp;"),e.height.value&&(n+=r+"height="+e.height.value,r="&amp;"),e.alt.value&&(n+=r+"alt="+e.alt.value,r="&amp;"),e.cssClass.value&&(n+=r+"class="+e.cssClass.value,r="&amp;"),e.mode_list&&(n+=r+"mode="+getSelectValue(e,"mode_list"),r="&amp;"),e.rel_list&&(n+=r+"rel="+getSelectValue(e,"rel_list")),n="{{image::"+n+"}}",t.selection.getNode(),t.execCommand("mceInsertRawHTML",!1,n),t.undoManager.add(),tinyMCEPopup.close()}};Typobox.preInit(),tinyMCEPopup.onInit.add(Typobox.init,Typobox);